@ECHO OFF
ECHO ÿ
ECHO INSTALL PROCEDURE FOR MONITOR-251  V1.1
ECHO COPYRIGHT KEIL ELEKTRONIK GmbH 1995 - 1999
ECHO ÿ
IF %1A == MODBINA GOTO MODOK
IF %1A == MODSRCA GOTO MODOK
IF %1A == modbinA GOTO MODOK
IF %1A == modsrcA GOTO MODOK
GOTO USAGE
:MODOK
IF %2A == A GOTO USAGE
IF %2 == 0 GOTO SERIAL0
IF %2 == 1 GOTO SERIAL1
IF %2 == 2 GOTO SERIAL2
IF %2 == 3 GOTO SERIAL3
GOTO USAGE
:SERIAL0
ECHO      USING TIMER1 FOR GENERATING SERIAL CLOCK 
ECHO      BAUDRATE: 9600 bps   at CPU CLOCK FREQUENCY 11.059 MHz
GOTO SERIALOK
:SERIAL1
ECHO      USING TIMER 2 FOR GENERATING SERIAL CLOCK
ECHO      BAUDRATE: 9600 bps   at CPU CLOCK FREQUENCY 12.000 MHz
GOTO SERIALOK
:SERIAL2
ECHO      USING Intel USBM Eval Board Rev. B with device N82930A02 Q8119 Sample
ECHO      BAUDRATE: 57600 bps  at CPU CLOCK FREQUENCY 12.000 MHz
GOTO SERIALOK
:SERIAL3
ECHO      USING Keil MCB251 Eval Board Rev. 2.0
ECHO      BAUDRATE: 57600 bps  at CPU CLOCK FREQUENCY 12.000 MHz
GOTO SERIALOK
:SERIALOK
ECHO      DATA START-ADDRESS:  %3  USING 32 BYTES
ECHO ÿ
ECHO TRANSLATE FILE: INSTALL.A51 ...
IF %4A == INTR2A GOTO INTR2_4
IF %4A == intr2A GOTO intr2_4
IF %4A == INTR4A GOTO INTR2_4
IF %4A == intr4A GOTO intr2_4
IF %4A == PAGEA  GOTO PAGE2
IF %4A == pageA  GOTO PAGE2
IF %4A == NOPAGEA  GOTO NOPAGE2
IF %4A == nopageA  GOTO NOPAGE2
:NOPAGE2
A251 INSTALL.A51 %1 SET (SERIAL = %2) %5
GOTO A251DONE

:PAGE2
A251 INSTALL.A51 %1 SET (SERIAL = %2, PAGEM) %5
GOTO A251DONE

:INTR2_4
IF %5A == PAGEA GOTO PAGE4
IF %5A == pageA GOTO PAGE4
IF %5A == NOPAGEA  GOTO NOPAGE4
IF %5A == nopageA  GOTO NOPAGE4
:NOPAGE4
A251 INSTALL.A51 %1 SET (SERIAL = %2) %4
GOTO A251DONE

:PAGE4
A251 INSTALL.A51 %1 SET (SERIAL = %2, PAGEM) %4
GOTO A251DONE

:A251DONE
ECHO ÿ

ECHO LINKING MONITOR-251 ...
L251 INSTALL.OBJ,MON251.LIB TO MON251 SE(?FD?MON251_DATA(%3)) CL(ECODE(0FF0000H))
ECHO ÿ

ECHO CONVERTING TO INTEL-HEX-FILE ...
OH251 MON251
ECHO ÿ
ECHO USE FILE MON251.HEX FOR PROM PROGRAMMING
GOTO EXIT

:USAGE
ECHO ERROR *** WRONG INVOCATION, USAGE:
ECHO ÿ
ECHO   INSTALL {MODBIN or MODSRC}  serialtype  datastart [intr [mode [CODESTART]]]
ECHO ÿ
ECHO   serialtype := 0  using TIMER 1  9600 bps at 11.059 MHz CPU Clock
ECHO   serialtype := 1  using TIMER 2  9600 bps at XTAL defined in INSTALL.A51
ECHO   serialtype := 2  Intel USBM Eval Board Rev.B  57600 bps
ECHO   serialtype := 3  Keil MCB251 Eval Board Rev.2.0  57600 bps
ECHO ÿ
ECHO   datastart is an address between 0x000420 and 0xFFFFE0 (no on-chip RAM!)
ECHO ÿ
ECHO   intr      defines the interrupt frame size and is one of the following
ECHO             INTR2 := Intr Frame Size 2 Bytes; INTR4 := Intr Frame Size 4 Bytes.
ECHO ÿ
ECHO   mode      configures the CPU operating mode and is one of the following
ECHO             PAGE := for PAGE mode; NOPAGE := for NOPAGE mode
ECHO ÿ
ECHO   codestart is an address between 0x001000 and 0xFFF000.
ECHO ÿ
ECHO EXAMPLES:   INSTALL MODBIN 1 0xFF7FE0
ECHO             INSTALL MODSRC 2 0xFFDFE0 INTR4 PAGE 0x001000
:EXIT
